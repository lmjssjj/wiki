```
frameworks/base/services/core/java/com/android/server/updates/IntentFirewallInstallReceiver.java
frameworks/base/services/core/java/com/android/server/firewall/IntentFirewall.java
```

```java
//是否中断启动应用
ActivityStarter->startActivity(){
     boolean abort = !mSupervisor.checkStartAnyActivityPermission(intent, aInfo, resultWho,
                requestCode, callingPid, callingUid, callingPackage, ignoreTargetSecurity,
                inTask != null, callerApp, resultRecord, resultStack);
        abort |= !mService.mIntentFirewall.checkStartActivity(intent, callingUid,
                callingPid, resolvedType, aInfo.applicationInfo);
        abort |= !mService.getPermissionPolicyInternal().checkStartActivity(intent, callingUid,
                callingPackage);
}
```

