# 相应class

```
frameworks/base/services/core/java/com/android/server/am/BatteryStatsService.java
frameworks/base/core/java/com/android/internal/os/PowerProfile.java
frameworks/base/core/java/com/android/internal/os/PowerCalculator.java
frameworks/base/core/res/res/xml/power_profile.xml
frameworks/base/core/java/com/andorid/internal/os/BatteryStatsHelper.java
frameworks/base/core/java/com/android/internal/os/BatteryStatsHistory.java
frameworks/base/core/java/com/android/internal/os/BatterySipper.java
```

# 电量计算

```
https://www.cnblogs.com/hellokitty2/p/12253075.html
https://mp.weixin.qq.com/s/9Pi-rHj-G2omqu3dCtuuZA

frameworks/base/core/java/com/andorid/internal/os/BatteryStatsHelper.java
	软件排行榜的计算算法：BatteryStatsHelper类中的processAppUsage()方法。
	硬件排行榜的计算算法：BatteryStatsHelper类中的processMiscUsage()方法。
processAppUsage->
	mStatsPeriod = mTypeBatteryRealtime; //耗电的统计时长
		mTypeBatteryRealtime = mStats.computeBatteryRealtime(rawRealtimeUs, mStatsType);
		private int mStatsType = BatteryStats.STATS_SINCE_CHARGED;
		//BatteryStats.STATS_SINCE_CHARGED，计算规则是从上次充满电后数据;另外STATS_SINCE_UNPLUGGED是拔掉		 		    //USB线后的数据。说明充电时间的计算是从上一次拔掉设备到现在的耗电量统计。
	totalPower = app.sumPower();//计算UID总耗电
```

```
mStatsHelper = new BatteryStatsHelper(activity, true);
```

# 电量读取

```

```

