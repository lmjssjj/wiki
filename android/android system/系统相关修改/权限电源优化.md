## 电源优化权限

```
//系统默认配置
frameworks\base\data\etc\platform.xml

//读取
//frameworks/base/services/core/java/com/android/server/DeviceIdleController.java
//用户设置的将最终写到
/data/system/deviceidle.xml文件中

//在systemconfig中读取
frameworks/base/core/java/com/android/server/SystemConfig.java
```

## 添加指定包名电源白名单

```java
frameworks/base/services/core/java/com/android/server/DeviceIdleController.java
public class DeviceIdleController extends SystemService{

    //添加自定义包名
	private static final List<String> CUSTOMER_POWER_SAVE_WHITELIST = new ArrayList<>();
    static{
        CUSTOMER_POWER_SAVE_WHITELIST.add("com.lmjssjj.ircontrol");
		CUSTOMER_POWER_SAVE_WHITELIST.add("com.nuumobile.livesupport");
    }
    
    public void onBootPhase(int phase) {
        //增加应用安装监听
        filter.addAction(Intent.ACTION_PACKAGE_ADDED);
    }
    private final BroadcastReceiver mReceiver = new BroadcastReceiver() {
        //应用安装监听处理
        case Intent.ACTION_PACKAGE_ADDED: {
                    if (!intent.getBooleanExtra(Intent.EXTRA_REPLACING, false)) {               	
                            if (intent.getData() !=null) {
                                String packageName = intent.getData().getSchemeSpecificPart();
                                Log.v("lmjssjj","install:"+packageName);
                                if(CUSTOMER_POWER_SAVE_WHITELIST.contains(packageName)){
                                    Log.v("lmjssjj","add to whitelist:"+packageName);
                                    addPowerSaveWhitelistAppInternal(packageName);
                                }
                            }
                        }
          } break;
    }
}
```

